(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{4482:(e,t,o)=>{"use strict";o.d(t,{default:()=>c});var r=o(5155),d=o(2115);let s=e=>{let{id:t,title:o,completed:d,onToggle:s,onDelete:l}=e;return(0,r.jsxs)("div",{className:"flex items-center justify-between p-4 border-b border-gray-200",children:[(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)("input",{type:"checkbox",checked:d,onChange:()=>s(t),className:"w-4 h-4 mr-2 rounded focus:ring-blue-500 border-gray-300 text-blue-600 bg-white"}),(0,r.jsx)("span",{className:"".concat(d?"line-through text-gray-400":"text-gray-900"),children:o})]}),(0,r.jsx)("button",{onClick:()=>l(t),className:"px-2 py-1 text-sm text-white bg-red-500 hover:bg-red-600 rounded focus:outline-none",children:"削除"})]})};var l=o(5453),i=o(1368);let a=(0,o(1935).createBrowserClient)("https://iivfakihvdxhynzszxbr.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImlpdmZha2lodmR4aHluenN6eGJyIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDc0NDM5MzksImV4cCI6MjA2MzAxOTkzOX0.2ihhm0C0lSSUDIrXIpmkX_a6_kE3IR0C1gXvnZXACL8"),n=(0,l.v)((e,t)=>({todos:[],inputText:"",loading:!1,error:null,setInputText:t=>e({inputText:t}),fetchTodos:async()=>{e({loading:!0,error:null});try{let{data:{user:t}}=await a.auth.getUser();if(!t)return void e({todos:[],loading:!1});let{data:o,error:r}=await a.from("todos").select("*").eq("user_id",t.id);if(r)throw r;e({todos:o||[],loading:!1})}catch(t){console.error("Error fetching todos:",t),e({error:t.message||"データの取得中にエラーが発生しました",loading:!1})}},addTodo:async()=>{let{inputText:o}=t();if(""===o.trim())return;let r="";try{let{data:{user:t}}=await a.auth.getUser();if(console.log(t),!t)return void e({error:"ログインが必要です"});let d={id:r=(0,i.A)(),title:o,completed:!1,user_id:t.id};e(e=>({todos:[d,...e.todos],inputText:"",error:null}));let{data:s,error:l}=await a.from("todos").insert([{title:o,completed:!1,user_id:t.id}]).select();if(l)throw l;e(e=>({todos:e.todos.map(e=>e.id===r?s[0]:e)}))}catch(t){console.error("Error adding todo:",t),e(e=>({todos:e.todos.filter(e=>e.id!==r),error:t.message||"Todoの追加中にエラーが発生しました"}))}},toggleTodo:async o=>{let r=t().todos.find(e=>e.id===o);if(r){e(e=>({todos:e.todos.map(e=>e.id===o?{...e,completed:!e.completed}:e)}));try{let{error:e}=await a.from("todos").update({completed:!r.completed}).eq("id",o);if(e)throw e}catch(t){console.error("Error toggling todo:",t),e(e=>({todos:e.todos.map(e=>e.id===o?r:e),error:t.message||"Todoの更新中にエラーが発生しました"}))}}},deleteTodo:async o=>{let r=t().todos;e(e=>({todos:e.todos.filter(e=>e.id!==o)}));try{let{error:e}=await a.from("todos").delete().eq("id",o);if(e)throw e}catch(t){console.error("Error deleting todo:",t),e({todos:r,error:t.message||"Todoの削除中にエラーが発生しました"})}}})),c=()=>{let{todos:e,inputText:t,loading:o,error:l,setInputText:i,addTodo:a,toggleTodo:c,deleteTodo:m,fetchTodos:h}=n();return(0,d.useEffect)(()=>{h()},[h]),(0,r.jsx)("div",{className:"min-h-screen py-10 bg-gray-50",children:(0,r.jsxs)("div",{className:"relative max-w-md p-6 mx-auto rounded-md shadow-md bg-white text-gray-700",children:[(0,r.jsx)("h1",{className:"mb-6 text-2xl font-bold text-center",children:"Todoリスト"}),l&&(0,r.jsx)("div",{className:"p-3 mb-4 rounded-md bg-red-100 text-red-700",children:l}),(0,r.jsxs)("div",{className:"flex mb-4",children:[(0,r.jsx)("input",{type:"text",value:t,onChange:e=>i(e.target.value),placeholder:"新しいタスクを入力...",className:"flex-1 px-4 py-2 border rounded-l focus:outline-none focus:ring-2 bg-white border-gray-300 text-gray-900 placeholder-gray-500 focus:ring-blue-500"}),(0,r.jsx)("button",{onClick:a,className:"px-4 py-2 text-white bg-blue-500 rounded-r hover:bg-blue-600 focus:outline-none",children:"追加"})]}),(0,r.jsx)("div",{className:"border rounded-md border-gray-200",children:o&&0===e.length?(0,r.jsx)("div",{className:"p-4 text-center text-gray-500",children:"読み込み中..."}):0===e.length?(0,r.jsx)("div",{className:"p-4 text-center text-gray-500",children:"タスクがありません"}):e.map(e=>(0,r.jsx)(s,{id:e.id,title:e.title,completed:e.completed,onToggle:c,onDelete:m},e.id))}),e.length>0&&(0,r.jsxs)("div",{className:"mt-4 text-sm text-gray-500",children:[e.filter(e=>e.completed).length,"／",e.length,"のタスクが完了"]})]})})}},5180:(e,t,o)=>{Promise.resolve().then(o.bind(o,4482))}},e=>{var t=t=>e(e.s=t);e.O(0,[774,441,684,358],()=>t(5180)),_N_E=e.O()}]);